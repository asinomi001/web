<!DOCTYPE html>
<html>
<head>
  <title>Friends & Chats</title>
  <link rel="icon" type="images/x-icon" href="images/title.ico" />
  <style>
    body { font-family: "Comic Sans MS", Arial, sans-serif; background: #f0f4ff; text-align: center; }
    h1 { color: #2b7cff; }
    .friend-list, .chat-list { margin: 20px auto; max-width: 600px; text-align: left; }
    .friend, .chat { padding: 10px; margin: 5px 0; background: white; border-radius: 6px; cursor: pointer; display: flex; align-items: center; }
    .friend img, .chat img { width: 40px; height: 40px; border-radius: 50%; margin-right: 10px; object-fit: cover; }
    .online { color: green; font-weight: bold; margin-left: auto; }
    button { background: #2b7cff; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; margin: 5px; transition: 0.2s; }
    button:hover { background: #1a5fd1; }
  </style>
</head>
<body>

<h1>Friends & Chats</h1>
<button id="backBtn">⬅ Back to Main</button>

<h2>Friends</h2>
<div class="friend-list" id="friendList"></div>

<h2>Chats</h2>
<div class="chat-list" id="chatList"></div>

<script>
// Проверка залогиненного пользователя
const currentUser = JSON.parse(localStorage.getItem('logged_user'));
if(!currentUser){ window.location.href = 'index.html'; }

// Данные друзей (пример)
const users = JSON.parse(localStorage.getItem('users_db')) || []; // Все пользователи
const friends = users.filter(u => u.id !== currentUser.id); // Все кроме себя

const friendList = document.getElementById('friendList');
friends.forEach(f => {
  const div = document.createElement('div');
  div.classList.add('friend');
  div.innerHTML = `<img src="${f.avatar || 'images/default_avatar.png'}" alt="avatar">
                   <span>${f.username || f.login}</span>
                   <span class="online">●</span>`;
  div.addEventListener('click', () => {
    localStorage.setItem('active_chat', f.id);
    window.location.href = 'chat.html';
  });
  friendList.appendChild(div);
});

// Список чатов (для примера, будем брать тех же друзей)
const chatList = document.getElementById('chatList');
friends.forEach(c => {
  const div = document.createElement('div');
  div.classList.add('chat');
  div.innerHTML = `<img src="${c.avatar || 'images/default_avatar.png'}" alt="avatar">
                   <span>${c.username || c.login}</span>`;
  div.addEventListener('click', () => {
    localStorage.setItem('active_chat', c.id);
    window.location.href = 'chat.html';
  });
  chatList.appendChild(div);
});

// Кнопка назад
document.getElementById('backBtn').addEventListener('click', () => {
  window.location.href = 'index.html';
});
</script>

</body>
</html>
