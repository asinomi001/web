<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign Up</title>
<link rel="icon" type="images/x-icon" href="images/title.ico" />
<style>
  body { font-family: Arial, sans-serif; background: #f0f4ff; text-align: center; }
  h1 { color: #2b7cff; }
  .avatar-option { width: 80px; height: 80px; border-radius: 50%; margin: 10px; border: 2px solid transparent; cursor: pointer; transition: transform 0.2s, border 0.2s; }
  .avatar-option.selected { border: 2px solid #2b7cff; transform: scale(1.1); }
  #preview { width: 100px; height: 100px; border-radius: 50%; margin: 10px; border: 2px solid #2b7cff; display: block; }
  input { display: block; margin: 10px auto; padding: 8px; width: 200px; border-radius: 6px; border: 1px solid #ccc; }
  button { background: #2b7cff; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; transition: background 0.2s; }
  button:hover { background: #1a5fd1; }
</style>
</head>
<body>
<h1>Sign Up</h1>
<input type="text" id="username" placeholder="Username">
<input type="text" id="name" placeholder="Name">
<input type="password" id="password" placeholder="Password">

<h3>Choose your avatar:</h3>
<div id="avatars">
  <img src="avatars/avatar1.png" class="avatar-option">
  <img src="avatars/avatar2.png" class="avatar-option">
  <img src="avatars/avatar3.png" class="avatar-option">
</div>

<h3>Or upload your own:</h3>
<input type="file" id="customAvatar" accept="image/*">
<img id="preview" src="" alt="Avatar Preview">

<button id="signupBtn">Register</button>

<script>
let selectedAvatar = '';
const avatarElements = document.querySelectorAll('.avatar-option');
const preview = document.getElementById('preview');

// Выбор готовой аватарки
avatarElements.forEach(img => {
  img.addEventListener('click', () => {
    avatarElements.forEach(a => a.classList.remove('selected'));
    img.classList.add('selected');
    selectedAvatar = img.src;
    preview.src = selectedAvatar;
  });
});

// Загрузка своей аватарки
document.getElementById('customAvatar').addEventListener('change', e => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(ev){
      preview.src = ev.target.result;
      selectedAvatar = ev.target.result;
      avatarElements.forEach(a => a.classList.remove('selected')); // снимаем выбор готовых аватарок
    };
    reader.readAsDataURL(file);
  }
});

// Регистрация
document.getElementById('signupBtn').addEventListener('click', () => {
  const username = document.getElementById('username').value.trim();
  const name = document.getElementById('name').value.trim();
  const password = document.getElementById('password').value.trim();

  if(!username || !name || !password || !selectedAvatar){
    alert('Please fill all fields and select or upload an avatar!');
    return;
  }

  const users = JSON.parse(localStorage.getItem('users') || '[]');
  if(users.some(u => u.username === username)){
    alert('Username already exists!');
    return;
  }

  const newUser = { id: users.length+1, username, name, password, avatar: selectedAvatar };
  users.push(newUser);
  localStorage.setItem('users', JSON.stringify(users));
  localStorage.setItem('logged_user', JSON.stringify(newUser));
  alert('Registration successful!');
  window.location.href = 'account.html';
});
</script>
</body>
</html>
